# 小鸡VPS终极优化脚本 (VPS-Optimizer-Ultimate)

这是一个专为低配置VPS（俗称“小鸡”）设计的轻量级、一键式自动化优化脚本。它旨在通过一个简单的交互式菜单，帮助用户快速完成系统更新、安全设置、网络加速和性能调优等一系列复杂操作。

## 核心特性

- **交互式菜单**：提供清晰的操作选项，既可一键全自动执行，也可按需选择单个功能。
- **智能系统检测**：自动识别并兼容主流的Linux发行版（Debian, Ubuntu, CentOS）。
- **安全与稳定优先**：所有优化选项均选用最稳定、兼容性最好的官方或社区公认方案。

## 主要功能详解

脚本集成了以下八大核心功能：

#### 1. 更新系统软件包
- **功能**：自动执行 `apt upgrade` 或 `yum update`，将系统所有已安装的软件包更新到最新版本，修复已知的安全漏洞和Bug。

#### 2. 开启root用户SSH登录
- **功能**：为了方便管理，此功能会引导您为`root`用户设置一个新密码，并修改SSH配置文件，允许`root`用户直接通过密码登录。
- **注意**：请务- 必设置一个高强度的复杂密码。

#### 3. 开启BBR+FQ网络加速
- **功能**：自动检测当前Linux内核版本。如果版本高于`4.9`，则会自动在系统配置中启用Google BBR拥塞控制算法和FQ队列管理，能显著提升服务器的网络吞吐量和响应速度，尤其是在国际链路上效果明显。

#### 4. 创建Swap虚拟内存
- **功能**：自动检测物理内存大小，并创建一个大小为物理内存**两倍**的Swap交换文件。这对于内存小于1GB的小鸡VPS至关重要，可以有效防止因内存耗尽（OOM, Out of Memory）而导致的服务崩溃。

#### 5. 清理系统垃圾文件
- **功能**：执行 `autoremove` 和 `clean` 等命令，清理不再需要的软件包依赖、缓存文件以及过期的系统日志，释放宝贵的磁盘空间。

#### 6. 优化DNS并强制IPv4优先
- **功能**：将系统的DNS解析服务器修改为更快速、更可靠的公共DNS（如 Google `8.8.8.8` 和 Cloudflare `1.1.1.1`）。同时，会配置系统优先使用IPv4网络，避免在某些网络环境下因IPv6导致的速度缓慢问题。

#### 7. 应用Linux内核参数优化
- **功能**：向 `/etc/sysctl.conf` 文件中追加一系列经过验证的内核优化参数。这些参数包括：
    - 增大TCP缓冲区，提升网络传输效率。
    - 增加TCP连接队列长度，应对高并发场景。
    - 开启TCP Fast Open，减少连接延迟。
    - 优化TIME-WAIT套接字重用，降低资源占用。
    - 增加系统最大文件描述符数量。

#### 8. 安装性能优化辅助工具
- **功能**：
    - **Haveged**：安装并启动`haveged`服务，这是一个熵生成器，可以解决因系统熵值过低导致的程序随机数生成缓慢、阻塞等问题，对依赖加密的应用有正面作用。
    - **Tuned** (仅CentOS)：安装并启用`tuned`服务，并将其配置文件设置为`virtual-guest`模式，这是专门为虚拟机环境优化的性能调优方案。

## 如何使用

只需一行命令，即可下载并运行此脚本：

```bash
wget -O optimizer.sh [您的vps.sh文件的Raw链接] && bash optimizer.sh
```
然后根据菜单提示选择 `1` 即可开始全自动优化。
