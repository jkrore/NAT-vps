gcloud config get-value project
nano åˆ·æœºè„šæœ¬.sh

#!/bin/bash

# --- ä¿„å‹’å†ˆ8æœºåŠ é€Ÿç‰ˆé…ç½® ---

# 1. é¡¹ç›® ID: (å·²æ ¹æ®æ‚¨çš„ä¿¡æ¯å¡«å†™)
PROJECT_ID="hallowed-trail-470604-k2"

# 2. å¯ç”¨åŒº: (å·²æ ¹æ®æ‚¨çš„ä¿¡æ¯å¡«å†™)
ZONE="us-west1-a"

# 3. å®ä¾‹åç§°åˆ—è¡¨: (å·²ä¸ºæ‚¨æ›´æ–°ä¸º8å°)
INSTANCES=("shuaji-1" "shuaji-2" "shuaji-3" "shuaji-4" "shuaji-5" "shuaji-6" "shuaji-7" "shuaji-8")

# --- ä»¥ä¸‹ä»£ç ä¸ºä¼˜åŒ–ç‰ˆï¼Œæ— éœ€ä¿®æ”¹ ---

echo "âœ… ä¿„å‹’å†ˆ8æœºåŠ é€Ÿé…ç½®åŠ è½½æˆåŠŸ:"
echo "é¡¹ç›® ID: $PROJECT_ID"
echo "å¯ç”¨åŒº: $ZONE"
echo "ç›®æ ‡å®ä¾‹: ${INSTANCES[@]}"
echo "----------------------------------------"

while true; do
  echo "ğŸš€ å¹¶å‘å¯åŠ¨æ‰€æœ‰å®ä¾‹..."
  for INSTANCE in "${INSTANCES[@]}"; do
    gcloud compute instances start "$INSTANCE" --zone "$ZONE" --project "$PROJECT_ID" --quiet &
  done
  wait
  echo "â³ ç­‰å¾… 45 ç§’..."
  sleep 45
  echo "ğŸ” å¼€å§‹é«˜é€Ÿæ£€æŸ¥æ‰€æœ‰å®ä¾‹ CPU..."
  FOUND_TARGET=""
  for INSTANCE in "${INSTANCES[@]}"; do
    echo -n "  -> æ­£åœ¨æ£€æŸ¥ $INSTANCE ... "
    CPU_PLATFORM=$(gcloud compute instances describe "$INSTANCE" --zone "$ZONE" --project "$PROJECT_ID" --format='value(cpuPlatform)')
    if [[ "$CPU_PLATFORM" == *"AMD"* ]]; then
      echo "ğŸ‰ å‘½ä¸­ AMDï¼"
      FOUND_TARGET="$INSTANCE"
      break
    else
      echo "ğŸš« Intel"
    fi
  done
  if [[ -n "$FOUND_TARGET" ]]; then
    echo "----------------------------------------"
    echo "âœ… æ­å–œï¼å®ä¾‹ '$FOUND_TARGET' æ˜¯ AMD CPUï¼"
    echo "ğŸ›‘ æ­£åœ¨åœæ­¢å…¶ä»–éç›®æ ‡å®ä¾‹..."
    for INSTANCE in "${INSTANCES[@]}"; do
      if [[ "$INSTANCE" != "$FOUND_TARGET" ]]; then
        gcloud compute instances stop "$INSTANCE" --zone "$ZONE" --project "$PROJECT_ID" --quiet &
      fi
    done
    wait
    echo "ğŸ¯ åˆ·æœºä»»åŠ¡å®Œæˆï¼"
    break
  else
    echo "----------------------------------------"
    echo "ğŸš« æœ¬è½®æœªå‘½ä¸­ã€‚æ­£åœ¨å…³åœæ‰€æœ‰å®ä¾‹..."
    for INSTANCE in "${INSTANCES[@]}"; do
      gcloud compute instances stop "$INSTANCE" --zone "$ZONE" --project "$PROJECT_ID" --quiet &
    done
    wait
    echo "ğŸ” 10ç§’åå¼€å§‹ä¸‹ä¸€è½®..."
    sleep 10
  fi
done


chmod +x åˆ·æœºè„šæœ¬.sh
tmux
./åˆ·æœºè„šæœ¬.sh
