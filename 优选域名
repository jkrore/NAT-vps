www.csgo.com
shopify.com
time.is
icook.hk
icook.tw
ip.sb
japan.com
malaysia.com
russia.com
singapore.com
skk.moe
www.visa.com.sg
www.visa.com.hk
www.visa.com.tw
www.visa.co.jp
www.visakorea.com
www.gco.gov.qa
www.gov.se
www.gov.ua



# ğŸŒ åŸŸå/IP åˆ—è¡¨ï¼ˆä¸å¸¦å¼•å·ï¼Œæ¯è¡Œä¸€ä¸ªï¼‰
$rawList = @'
www.csgo.com
shopify.com
time.is
icook.hk
icook.tw
ip.sb
japan.com
malaysia.com
russia.com
singapore.com
skk.moe
www.visa.com.sg
www.visa.com.hk
www.visa.com.tw
www.visa.co.jp
www.visakorea.com
www.gco.gov.qa
www.gov.se
www.gov.ua
'@ -split "`r?`n"

# ğŸ“¦ å­˜å‚¨ç»“æœ
$results = @()
$jobs = @()

# ğŸš€ å¹¶å‘ pingï¼ˆæ¯ä¸ªä»»åŠ¡ç‹¬ç«‹å¤„ç†å¼‚å¸¸ï¼‰
foreach ($target in $rawList) {
    if ($target.Trim() -ne "") {
        $jobs += Start-Job -ScriptBlock {
            param($t)
            try {
                $ping = Test-Connection -Count 3 -ComputerName $t -ErrorAction Stop
                $avg = ($ping | Measure-Object -Property ResponseTime -Average).Average
                [PSCustomObject]@{ Target = $t; AvgLatency = [math]::Round($avg, 2); Status = "âœ… æ­£å¸¸" }
            } catch {
                [PSCustomObject]@{ Target = $t; AvgLatency = $null; Status = "âŒ è¶…æ—¶/å¤±è´¥" }
            }
        } -ArgumentList $target
    }
}

# â³ ç­‰å¾…ä»»åŠ¡å®Œæˆ
$jobs | ForEach-Object { Wait-Job $_ }

# ğŸ“¥ æ”¶é›†ç»“æœ
foreach ($job in $jobs) {
    try {
        $output = Receive-Job $job
        $results += $output
    } catch {
        $results += [PSCustomObject]@{ Target = "æœªçŸ¥ä»»åŠ¡"; AvgLatency = $null; Status = "âŒ æ¥æ”¶å¤±è´¥" }
    }
    Remove-Job $job
}

# ğŸ“Š æ’åºè¾“å‡º
$success = $results | Where-Object { $_.AvgLatency -ne $null } | Sort-Object AvgLatency
$failed  = $results | Where-Object { $_.AvgLatency -eq $null }

Write-Host "`nğŸ† Ping å»¶è¿Ÿæ’è¡Œæ¦œï¼ˆå•ä½ï¼šmsï¼‰" -ForegroundColor Cyan
$success | ForEach-Object {
    Write-Host ("{0,-30} : {1,6} ms {2}" -f $_.Target, $_.AvgLatency, $_.Status) -ForegroundColor Green
}

if ($failed.Count -gt 0) {
    Write-Host "`nâŒ æ— æ³• ping çš„ç›®æ ‡ï¼š" -ForegroundColor Red
    $failed | ForEach-Object {
        Write-Host ("{0,-30} : {1}" -f $_.Target, $_.Status) -ForegroundColor DarkRed
    }
}

